<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="unsafe-url">
    <title>å¼•èæµ‹è¯•é¡µé¢</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        .test-link {
            display: inline-block;
            background: #007bff;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin: 5px;
            transition: background 0.2s;
        }
        .test-link:hover {
            background: #0056b3;
            color: white;
        }
        .social { background: #1877f2; }
        .tech { background: #24292e; }
        .news { background: #ff6600; }
        .search { background: #34a853; }
        
        .note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .debug {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>ğŸ”— å¼•èæ¥æºæµ‹è¯•é¡µé¢</h1>
    
    <div class="note">
        <strong>ğŸ“ æµ‹è¯•è¯´æ˜ï¼š</strong><br>
        è¿™ä¸ªé¡µé¢è¿è¡Œåœ¨æ‚¨çš„æœ¬åœ°æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥æ­£ç¡®ä¼ é€’referrerä¿¡æ¯ã€‚<br>
        å½“å‰é¡µé¢URL: <span id="current-url"></span>
    </div>

    <div class="debug">
        <strong>ğŸ” è°ƒè¯•ä¿¡æ¯ï¼š</strong><br>
        <div id="debug-info">åŠ è½½ä¸­...</div>
    </div>

    <div class="test-section">
        <h2>ğŸ“± ç¤¾äº¤åª’ä½“å¼•èæµ‹è¯•</h2>
        <p>æ¨¡æ‹Ÿä»ç¤¾äº¤åª’ä½“å¹³å°çš„è®¿é—®ï¼š</p>
        <a href="/" class="test-link social" data-referrer="https://www.zhihu.com/question/123456789">
            ä»çŸ¥ä¹è®¿é—® (æ¨¡æ‹Ÿ)
        </a>
        <a href="/" class="test-link social" data-referrer="https://weibo.com/timeline">
            ä»å¾®åšè®¿é—® (æ¨¡æ‹Ÿ)
        </a>
        <a href="/" class="test-link social" data-referrer="https://www.linkedin.com/feed/">
            ä»LinkedInè®¿é—® (æ¨¡æ‹Ÿ)
        </a>
    </div>

    <div class="test-section">
        <h2>ğŸ’» æŠ€æœ¯ç¤¾åŒºå¼•èæµ‹è¯•</h2>
        <p>æ¨¡æ‹Ÿä»æŠ€æœ¯ç¤¾åŒºçš„è®¿é—®ï¼š</p>
        <a href="/" class="test-link tech" data-referrer="https://github.com/awesome/sports-api">
            ä»GitHubè®¿é—® (æ¨¡æ‹Ÿ)
        </a>
        <a href="/" class="test-link tech" data-referrer="https://stackoverflow.com/questions/sports-api">
            ä»Stack Overflowè®¿é—® (æ¨¡æ‹Ÿ)
        </a>
        <a href="/" class="test-link tech" data-referrer="https://v2ex.com/t/sports-streaming">
            ä»V2EXè®¿é—® (æ¨¡æ‹Ÿ)
        </a>
    </div>

    <div class="test-section">
        <h2>ğŸ”— çœŸå®å¼•èæµ‹è¯•</h2>
        <p>ä½¿ç”¨å®é™…çš„å¤–éƒ¨é“¾æ¥ï¼ˆå¦‚æœå…è®¸çš„è¯ï¼‰ï¼š</p>
        <a href="/" class="test-link">ç›´æ¥é“¾æ¥åˆ°é¦–é¡µ</a>
        <a href="/contact" class="test-link">ç›´æ¥é“¾æ¥åˆ°è”ç³»é¡µé¢</a>
    </div>

    <div class="note">
        <strong>âš ï¸ é‡è¦æç¤ºï¼š</strong><br>
        ç”±äºç°ä»£æµè§ˆå™¨çš„å®‰å…¨ç­–ç•¥ï¼Œä»æœ¬åœ°æ–‡ä»¶(file://)è®¿é—®ç½‘ç«™æ—¶referrerå¯èƒ½è¢«é˜»æ­¢ã€‚<br>
        å»ºè®®ä½¿ç”¨ï¼š<code>http://localhost:3000/test-referrer.html</code> è®¿é—®æ­¤é¡µé¢è¿›è¡Œæµ‹è¯•ã€‚
    </div>

    <script>
        // æ˜¾ç¤ºå½“å‰é¡µé¢ä¿¡æ¯
        document.getElementById('current-url').textContent = window.location.href;
        
        // æ˜¾ç¤ºè°ƒè¯•ä¿¡æ¯
        function updateDebugInfo() {
            const debugInfo = document.getElementById('debug-info');
            debugInfo.innerHTML = `
                <strong>å½“å‰é¡µé¢:</strong> ${window.location.href}<br>
                <strong>Referrer:</strong> ${document.referrer || '(æ— )'}<br>
                <strong>åè®®:</strong> ${window.location.protocol}<br>
                <strong>æ—¶é—´:</strong> ${new Date().toLocaleString()}
            `;
        }
        updateDebugInfo();

        // ä¸ºæ¨¡æ‹Ÿé“¾æ¥æ·»åŠ ç‚¹å‡»å¤„ç†
        document.querySelectorAll('a[data-referrer]').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetUrl = this.href;
                const fakeReferrer = this.getAttribute('data-referrer');
                
                // åœ¨æ–°çª—å£ä¸­æ‰“å¼€ï¼Œå¹¶å°è¯•è®¾ç½®referrerï¼ˆå¯èƒ½è¢«æµè§ˆå™¨é˜»æ­¢ï¼‰
                const newWindow = window.open(targetUrl, '_blank');
                
                // æ˜¾ç¤ºä¿¡æ¯ç»™ç”¨æˆ·
                alert(`å³å°†è·³è½¬åˆ°: ${targetUrl}\næ¨¡æ‹Ÿreferrer: ${fakeReferrer}\n\nå®é™…çš„referrerå°†æ˜¯å½“å‰é¡µé¢URL: ${window.location.href}`);
            });
        });

        // æ¯ç§’æ›´æ–°è°ƒè¯•ä¿¡æ¯
        setInterval(updateDebugInfo, 1000);
    </script>
</body>
</html>
